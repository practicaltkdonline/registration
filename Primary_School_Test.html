<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025香港小學跆拳道隊際賽 Hong Kong Primary School Taekwondo Competition 2025</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', Arial, sans-serif;
      max-width: 900px;
      margin: 1rem auto;
      padding: 1rem;
      background: linear-gradient(135deg, #e6f0fa, #d9e6f5);
      color: #2d3748;
      line-height: 1.7;
      min-height: 100vh;
    }
    .form-container {
      background: #ffffff;
      padding: 2rem;
      border-radius: 1.2rem;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .form-container:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.18);
    }
    .form-header {
      text-align: center;
      margin-bottom: 2.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #edf2f7;
    }
    .form-header h1 {
      font-size: 1.8rem;
      font-weight: 700;
      color: #1a202c;
      margin: 0;
    }
    .form-header h2 {
      font-size: 1.2rem;
      font-weight: 500;
      color: #718096;
      margin-top: 0.5rem;
    }
    .form-group {
      margin-bottom: 1.5rem;
      padding: 1.2rem;
      border-radius: 1rem;
      background: #f7fafc;
      transition: background 0.3s ease, transform 0.2s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    .form-group:hover {
      background: #edf2f7;
      transform: translateY(-2px);
    }
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      font-size: 1rem;
      color: #2d3748;
    }
    input, select, button {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid #e2e8f0;
      border-radius: 0.6rem;
      box-sizing: border-box;
      font-size: 1rem;
      background: #ffffff;
      transition: border-color 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
      height: 2.8rem;
    }
    input:focus, select:focus, button:focus {
      outline: none;
      border-color: #3182ce;
      box-shadow: 0 0 6px rgba(49, 130, 206, 0.4);
      background: #f8fbff;
    }
    input:disabled, select:disabled {
      background: #edf2f7;
      color: #a0aec0;
      cursor: not-allowed;
    }
    .date-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .date-group select {
      width: 7rem;
      max-width: 100%;
    }
    .date-group select#birthYear {
      width: 9rem;
      max-width: 100%;
    }
    .date-group span {
      font-size: 1rem;
      color: #2d3748;
    }
    .category-group {
      display: flex;
      gap: 1rem;
      padding: 0.5rem 0;
    }
    .category-group label {
      display: flex;
      align-items: center;
      font-weight: 500;
      font-size: 1rem;
      color: #2d3748;
    }
    .category-group input[type="radio"] {
      width: auto;
      margin-right: 0.8rem;
      transform: scale(0.88);
    }
    .category-group label.disabled {
      color: #a0aec0;
      pointer-events: none;
    }
    .category-group input[type="radio"]:disabled {
      opacity: 0.6;
    }
    .error {
      color: #e53e3e;
      font-size: 0.85rem;
      margin-top: 0.4rem;
      display: none;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.75);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background-color: #ffffff;
      padding: 2rem;
      border-radius: 1.2rem;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 10px 28px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      max-height: 85vh;
    }
    .modal-scroll {
      overflow-y: auto;
      flex-grow: 1;
      margin-bottom: 1.5rem;
      padding-right: 0.8rem;
    }
    .modal-content p {
      font-size: 1rem;
      margin: 0.8rem 0;
      color: #2d3748;
    }
    button.confirm, button.return-button {
      background: linear-gradient(90deg, #3182ce, #2b6cb0);
      color: white;
      border: none;
      cursor: pointer;
      padding: 0.8rem;
      border-radius: 0.6rem;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    button.confirm:hover, button.return-button:hover {
      background: linear-gradient(90deg, #2b6cb0, #2c5282);
      transform: translateY(-2px);
    }
    button.cancel {
      background: #edf2f7;
      color: #718096;
      padding: 0.8rem;
      border: none;
      border-radius: 0.6rem;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    button.cancel:hover {
      background: #e2e8f0;
      transform: translateY(-2px);
    }
    #submitBtn {
      background: linear-gradient(90deg, #38a169, #2f855a);
      color: white;
      margin-top: 1.5rem;
      padding: 1rem;
      border: none;
      border-radius: 0.6rem;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
      font-weight: 600;
      font-size: 1.1rem;
    }
    #submitBtn:hover {
      background: linear-gradient(90deg, #2f855a, #276749);
      transform: translateY(-3px);
    }
    #thankYouPage {
      display: none;
      background: #ffffff;
      padding: 2rem;
      border-radius: 1.2rem;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      text-align: center;
      transition: transform 0.3s ease;
    }
    #thankYouPage:hover {
      transform: translateY(-4px);
    }
    #thankYouPage h2 {
      font-size: 1.6rem;
      margin-bottom: 1rem;
      color: #1a202c;
    }
    #thankYouPage p {
      font-size: 1rem;
      margin: 1rem 0;
      color: #38a169;
    }
    @media (max-width: 600px) {
      body {
        padding: 0.5rem;
        margin: 0.5rem;
      }
      .form-container, #thankYouPage {
        padding: 1.2rem;
        margin: 0.5rem;
        border-radius: 0.8rem;
      }
      .form-header h1 {
        font-size: 1.4rem;
      }
      .form-header h2 {
        font-size: 1rem;
      }
      .form-group {
        padding: 0.8rem;
        margin-bottom: 1rem;
      }
      input, select, button {
        padding: 0.7rem;
        font-size: 0.9rem;
        height: 2.5rem;
        border-radius: 0.5rem;
      }
      .date-group {
        gap: 0.4rem;
      }
      .date-group select {
        width: 5.5rem;
      }
      .date-group select#birthYear {
        width: 7rem;
      }
      .category-group {
        gap: 0.6rem;
        flex-wrap: wrap;
      }
      .modal-content {
        width: 95%;
        padding: 1.2rem;
        max-height: 90vh;
        border-radius: 0.8rem;
      }
      .modal-content p {
        font-size: 0.9rem;
      }
      button.confirm, button.cancel, button.return-button, #submitBtn {
        padding: 0.7rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="form-container" id="mainForm">
    <div class="form-header">
      <h1>2025香港小學跆拳道隊際賽</h1>
      <h1>Hong Kong Primary School Taekwondo Competition 2025</h1>
      <h2>家長用報名表</h2>
    </div>
    <form id="registrationForm">
      <div class="form-group">
        <label>就讀小學名稱 School Name *</label>
        <input type="text" id="schoolName" name="entry.1714227241" placeholder="以學生證上的中文名稱為準" required>
        <span id="schoolNameError" class="error">請輸入小學名稱</span>
      </div>
      <div class="form-group">
        <label>學生證編號 Student ID *</label>
        <input type="text" id="studentId" name="entry.1045318375" required>
        <span id="studentIdError" class="error">請輸入學生證編號</span>
      </div>
      <div class="form-group">
        <label>屬會名稱 Association *</label>
        <input list="affiliations" id="affiliation" name="entry.1597491054" required placeholder="點擊輸入或選擇屬會名稱">
        <datalist id="affiliations">
          <option value="香港仔跆拳道會 Aberdeen TKD Club">
          <option value="技擊跆拳道會 Advanced TKD Association">
          <option value="躍駿跆拳道會 Attack TKD Association">
          <option value="青雲跆拳道會 Ching Wan TKD Association">
          <option value="精英跆拳道會 Ching Ying TKD Union">
          <option value="金柏跆拳道協會 Combat TKD Association">
          <option value="香港跆拳道東龍會 Eastern Dragon TKD Federation HK">
          <option value="勵志跆拳道總會 Encouragement TKD Association">
          <option value="香港智道跆拳總會 HK Chido TKD Association">
          <option value="香港啟聯跆拳道協會 HK Kai Luen TKD Association">
          <option value="香港尼泊爾跆拳道會 HK Nepalese TKD Club">
          <option value="香港實用跆拳道協會 HK Practical TKD Association">
          <option value="香港跆拳道振武館 HK TKD Chun Mo Kwan">
          <option value="香港跆拳道勵進會 HK TKD Action Association">
          <option value="香港跆拳道勵誠會 HK TKD Active Association">
          <option value="香港跆拳道勵輝會 HK TKD Actual Association">
          <option value="香港中道跆拳道會 HK Chong Do TKD Association">
          <option value="香港跆拳道青濤館 HK TKD Chung Do Kwan">
          <option value="香港跆拳道正道館 HK TKD Jung Do Kwan">
          <option value="香港跆拳道正心館 HK TKD Jung Sim Kwan">
          <option value="香港聯盟跆拳道協會 HK United TKD Association">
          <option value="跆拳道明道會 TKD Bright Way Association">
          <option value="漢道跆拳道館 Hon Do TKD Kwan">
          <option value="國際跆拳道香港總會 International TKD HK Association">
          <option value="韓國跆拳道青道館 Korea TKD Cheung Do Kwan">
          <option value="樂華跆拳道會 Lok Wah TKD Club">
          <option value="銘英跆拳道會 Main Pioneer TKD Association">
          <option value="跆拳道武德會 Moo Duk TKD Hae">
          <option value="伍華跆拳道會 Ng Wah TKD Club">
          <option value="毅武聯盟跆拳道 Ngai Mo Alliance TKD">
          <option value="香港警察跆拳道會 HK Police TKD Club">
          <option value="香港跆拳道國藝會 Potential TKD HK Association">
          <option value="尚武聯跆拳道會 Sheung Mo Luen TKD Association">
          <option value="捷擊跆拳道館 TKD Jet Kick Kwan">
          <option value="跆拳道吾道會體育館 TKD Oh Do Hae Gymnasium">
          <option value="香港胡氏跆拳道會 Wu's TKD HK Association">
          <option value="正武會跆拳道協會 Zheng Wu TKD Association">
          <option value="香港發景跆拳道會 Hong Kong Greatview TKD Club">
          <option value="香港跆拳道柏毅會 Hong Kong TKD Pak Ngai Association">
          <option value="香港跆拳道嚴濤會 Hong Kong TKD Uhm Do Club">
          <option value="威格跆拳道會 Warrior TKD Club">
          <option value="金道跆拳道聯盟 The Kimdo TKD Federation">
          <option value="金道一跆拳道館 Kim Do Yi TKD Kwan">
          <option value="樂武跆拳道會 Cheerful TKD Association Limited">
          <option value="世紀跆拳道會 H.K. Taekwondo Cosmopolitan Club">
          <option value="燊．跆拳道館 Sun Taekwondo Club">
          <option value="香港進和跆拳道會 Hong Kong Chun Wo Taekwondo Association">
          <option value="香港賢薈跆拳道會 Hong Kong Ultimate Taekwondo Club">
        </datalist>
        <span id="affiliationError" class="error">請選擇或輸入屬會名稱</span>
      </div>
      <div class="form-group">
        <label>跆協段證/色帶會員証編號 Membership No. *</label>
        <input type="text" id="membershipNumber" name="entry.1820097193" required>
        <span id="membershipNumberError" class="error">請輸入會員証編號</span>
      </div>
      <div class="form-group">
        <label>中文姓名 Chinese Name *</label>
        <input type="text" id="chineseName" name="entry.1739837016" placeholder="如沒有請填寫英文姓名 (請以大寫字母填寫)" required oninput="if(!/[\u4e00-\u9fa5]/.test(this.value)) this.value = this.value.toUpperCase()">
        <span id="chineseNameError" class="error">請輸入中文姓名或英文姓名</span>
      </div>
      <div class="form-group">
        <label>英文姓名 English Name *</label>
        <input type="text" id="englishName" name="entry.69039678" placeholder="請以大寫字母填寫" required oninput="this.value = this.value.toUpperCase()">
        <span id="englishNameError" class="error">請輸入英文姓名</span>
      </div>
      <div class="form-group">
        <label>出生日期 Date of Birth YYYY-MM-DD *</label>
        <div class="date-group">
          <select id="birthYear" name="entry.71284989_year" required>
            <option value="">年</option>
          </select>
          <span>/</span>
          <select id="birthMonth" name="entry.71284989_month" required>
            <option value="">月</option>
          </select>
          <span>/</span>
          <select id="birthDay" name="entry.71284989_day" required>
            <option value="">日</option>
          </select>
        </div>
        <input type="hidden" id="birthDate" name="entry.71284989">
        <span id="birthDateError" class="error">請選擇有效的出生日期</span>
      </div>
      <div class="form-group">
        <label>性別 Gender *</label>
        <div class="category-group">
          <label><input type="radio" name="entry.1294289670" value="男 Male" required> 男 Male</label>
          <label><input type="radio" name="entry.1294289670" value="女 Female"> 女 Female</label>
        </div>
        <span id="genderError" class="error">請選擇性別</span>
      </div>
      <div class="form-group">
        <label>聯絡電話 Telephone Number *</label>
        <input type="tel" id="phone" name="entry.269558714" pattern="\d{8}" required>
        <span id="phoneError" class="error">請輸入有效的8位電話號碼</span>
      </div>
      <div class="form-group">
        <label>現有級別 Present Grade Held *</label>
        <select id="beltLevel" name="entry.274850195" required>
          <option value="">請選擇級別</option>
          <option value="黃帶 Yellow Belt">黃帶 Yellow Belt</option>
          <option value="黃綠帶 Yellow-Green Belt">黃綠帶 Yellow-Green Belt</option>
          <option value="綠帶 Green Belt">綠帶 Green Belt</option>
          <option value="綠藍帶 Green-Blue Belt">綠藍帶 Green-Blue Belt</option>
          <option value="藍帶 Blue Belt">藍帶 Blue Belt</option>
          <option value="藍紅帶 Blue-Red Belt">藍紅帶 Blue-Red Belt</option>
          <option value="紅帶 Red Belt">紅帶 Red Belt</option>
          <option value="紅黑帶 Red-Black Belt">紅黑帶 Red-Black Belt</option>
          <option value="品一 Poom 1">品一 Poom 1</option>
          <option value="品二 Poom 2">品二 Poom 2</option>
          <option value="品三或上 Poom 3 or above">品三或上 Poom 3 or above</option>
        </select>
        <span id="beltLevelError" class="error">請選擇現有級別</span>
      </div>
      <div class="form-group">
        <label>參賽項目 Event *</label>
        <div class="category-group">
          <label><input type="radio" name="entry.629960054" value="搏擊" id="kyorugiRadio" required> 搏擊</label>
          <label><input type="radio" name="entry.629960054" value="品勢" id="poomsaeRadio"> 品勢</label>
          <label><input type="radio" name="entry.629960054" value="搏擊及品勢" id="bothRadio"> 搏擊及品勢</label>
        </div>
        <span id="eventError" class="error">請選擇參賽項目</span>
      </div>
      <div class="form-group">
        <label>參賽者高度 Height (cm)</label>
        <input type="number" id="height" name="entry.703788026" disabled>
        <span id="heightError" class="error">請輸入有效的身高</span>
      </div>
      <div class="form-group">
        <label>參賽者重量 Weight (kg)</label>
        <input type="number" id="weight" name="entry.1666612578" disabled>
        <span id="weightError" class="error">請輸入有效的體重</span>
      </div>
      <div class="form-group">
        <label>搏擊級別劃分 Kyorugi Division</label>
        <select id="kyorugiDivision" name="entry.1924363147" disabled>
          <option value="">請選擇搏擊級別</option>
        </select>
        <span id="kyorugiDivisionError" class="error">請選擇搏擊級別</span>
      </div>
      <div class="form-group">
        <label>搏擊量級 Weight Class</label>
        <select id="weightClass" name="entry.1084612574" disabled>
          <option value="">請選擇搏擊量級</option>
        </select>
        <span id="weightClassError" class="error">請選擇搏擊量級</span>
      </div>
      <div class="form-group">
        <label>品勢級別劃分 Poomsae Division</label>
        <select id="poomsaeDivision" name="entry.1721761818" disabled>
          <option value="">請選擇品勢級別</option>
        </select>
        <span id="poomsaeDivisionError" class="error">請選擇品勢級別</span>
      </div>
      <div class="form-group">
        <label>參賽品勢 Poomsae Event</label>
        <select id="poomsaeEvent" name="entry.1921234097" disabled>
          <option value="">請選擇參賽品勢</option>
        </select>
        <span id="poomsaeEventError" class="error">請選擇參賽品勢</span>
      </div>
      <button type="button" id="submitBtn" onclick="submitForm()">提交表單</button>
    </form>
  </div>

  <div id="confirmModal" class="modal">
    <div class="modal-content">
      <div class="modal-scroll">
        <h2>請確認您的報名資料</h2>
        <p><strong>就讀小學名稱：</strong> <span id="confirmSchoolName"></span></p>
        <p><strong>學生證編號：</strong> <span id="confirmStudentId"></span></p>
        <p><strong>屬會名稱：</strong> <span id="confirmAffiliation"></span></p>
        <p><strong>跆協段證/色帶會員証編號：</strong> <span id="confirmMembershipNumber"></span></p>
        <p><strong>中文姓名：</strong> <span id="confirmChineseName"></span></p>
        <p><strong>英文姓名：</strong> <span id="confirmEnglishName"></span></p>
        <p><strong>出生日期：</strong> <span id="confirmBirthDate"></span></p>
        <p><strong>性別：</strong> <span id="confirmGender"></span></p>
        <p><strong>聯絡電話：</strong> <span id="confirmPhone"></span></p>
        <p><strong>現有級別：</strong> <span id="confirmBeltLevel"></span></p>
        <p><strong>參賽項目：</strong> <span id="confirmEvent"></span></p>
        <p id="kyorugiFields" style="display: none;">
          <strong>參賽者高度：</strong> <span id="confirmHeight"></span><br>
          <strong>參賽者重量：</strong> <span id="confirmWeight"></span><br>
          <strong>搏擊級別劃分：</strong> <span id="confirmKyorugiDivision"></span><br>
          <strong>搏擊量級：</strong> <span id="confirmWeightClass"></span>
        </p>
        <p id="poomsaeFields" style="display: none;">
          <strong>品勢級別劃分：</strong> <span id="confirmPoomsaeDivision"></span><br>
          <strong>參賽品勢：</strong> <span id="confirmPoomsaeEvent"></span>
        </p>
      </div>
      <div style="display: flex; gap: 0.6rem;">
        <button class="cancel" onclick="cancelSubmission()">取消</button>
        <button class="confirm" onclick="confirmSubmission()">確認提交</button>
      </div>
    </div>
  </div>

  <div id="thankYouPage">
    <h2>感謝您的報名！</h2>
    <p>確認後教練將盡快與您聯繫核對資料。</p>
    <p>請將家長同意書、會員證及學生證副本交給教練。</p>
    <button class="return-button" onclick="restartForm()">重新報名</button>
  </div>

  <script>
    // 級別映射
    const beltMapping = {
      '黃帶 Yellow Belt': '1',
      '黃綠帶 Yellow-Green Belt': '2',
      '綠帶 Green Belt': '3',
      '綠藍帶 Green-Blue Belt': '4',
      '藍帶 Blue Belt': '5',
      '藍紅帶 Blue-Red Belt': '6',
      '紅帶 Red Belt': '7',
      '紅黑帶 Red-Black Belt': '8',
      '品一 Poom 1': '9',
      '品二 Poom 2': '10',
      '品三或上 Poom 3 or above': '11'
    };

    // 搏擊級別劃分
    const kyorugiDivisions = {
      '男 Male': {
        '2015-2017': '男童色帶A組 Boys Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)',
        '2013-2014': '男童色帶B組 Boys Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)',
        '2011-2012': '男童色帶C組 Boys Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)'
      },
      '女 Female': {
        '2015-2017': '女童色帶A組 Girls Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)',
        '2013-2014': '女童色帶B組 Girls Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)',
        '2011-2012': '女童色帶C組 Girls Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)'
      }
    };

    // 搏擊量級
    const weightClasses = {
      '男童色帶A組 Boys Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)': [
        'FIN 鰭量級 (25公斤以上而不超過27公斤)',
        'FLY 蠅量級 (27公斤以上而不超過29公斤)',
        'BANTAM 雛量級 (29公斤以上而不超過31公斤)',
        'FEATHER 羽量級 (31公斤以上而不超過34公斤)',
        'LIGHT 輕量級 (34公斤以上而不超過37公斤)',
        'WELTER 沉量級 (37公斤以上而不超過40公斤)',
        'LIGHT MIDDLE 輕中量級 (40公斤以上而不超過43公斤)',
        'MIDDLE 中量級 (43公斤以上而不超過46公斤)',
        'LIGHT HEAVY 輕重量級 (46公斤以上而不超過49公斤)',
        'HEAVY 重量級 (49公斤以上而不超過57公斤)'
      ],
      '男童色帶B組 Boys Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)': [
        'FIN 鰭量級 (28公斤以下)',
        'FLY 蠅量級 (28公斤以上而不超過30公斤)',
        'BANTAM 雛量級 (30公斤以上而不超過32公斤)',
        'FEATHER 羽量級 (32公斤以上而不超過35公斤)',
        'LIGHT 輕量級 (35公斤以上而不超過38公斤)',
        'WELTER 沉量級 (38公斤以上而不超過41公斤)',
        'LIGHT MIDDLE 輕中量級 (41公斤以上而不超過44公斤)',
        'MIDDLE 中量級 (44公斤以上而不超過47公斤)',
        'LIGHT HEAVY 輕重量級 (47公斤以上而不超過50公斤)',
        'HEAVY 重量級 (50公斤以上而不超過58公斤)'
      ],
      '男童色帶C組 Boys Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)': [
        'FIN 鰭量級 (31公斤以下)',
        'FLY 蠅量級 (31公斤以上而不超過34公斤)',
        'BANTAM 雛量級 (34公斤以上而不超過37公斤)',
        'FEATHER 羽量級 (37公斤以上而不超過39公斤)',
        'LIGHT 輕量級 (39公斤以上而不超過42公斤)',
        'WELTER 沉量級 (42公斤以上而不超過44公斤)',
        'LIGHT MIDDLE 輕中量級 (44公斤以上而不超過47公斤)',
        'MIDDLE 中量級 (47公斤以上而不超過50公斤)',
        'LIGHT HEAVY 輕重量級 (50公斤以上而不超過54公斤)',
        'HEAVY 重量級 (54公斤以上而不超過62公斤)'
      ],
      '女童色帶A組 Girls Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)': [
        'FIN 鰭量級 (21公斤以上而不超過24公斤)',
        'FLY 蠅量級 (24公斤以上而不超過27公斤)',
        'BANTAM 雛量級 (27公斤以上而不超過30公斤)',
        'FEATHER 羽量級 (30公斤以上而不超過33公斤)',
        'LIGHT 輕量級 (33公斤以上而不超過36公斤)',
        'WELTER 沉量級 (36公斤以上而不超過39公斤)',
        'LIGHT MIDDLE 輕中量級 (39公斤以上而不超過42公斤)',
        'MIDDLE 中量級 (42公斤以上而不超過45公斤)',
        'LIGHT HEAVY 輕重量級 (45公斤以上而不超過48公斤)',
        'HEAVY 重量級 (48公斤以上而不超過52公斤)'
      ],
      '女童色帶B組 Girls Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)': [
        'FIN 鰭量級 (22公斤以上而不超過25公斤)',
        'FLY 蠅量級 (25公斤以上而不超過28公斤)',
        'BANTAM 雛量級 (28公斤以上而不超過31公斤)',
        'FEATHER 羽量級 (31公斤以上而不超過34公斤)',
        'LIGHT 輕量級 (34公斤以上而不超過37公斤)',
        'WELTER 沉量級 (37公斤以上而不超過40公斤)',
        'LIGHT MIDDLE 輕中量級 (40公斤以上而不超過43公斤)',
        'MIDDLE 中量級 (43公斤以上而不超過46公斤)',
        'LIGHT HEAVY 輕重量級 (46公斤以上而不超過49公斤)',
        'HEAVY 重量級 (49公斤以上而不超過53公斤)'
      ],
      '女童色帶C組 Girls Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)': [
        'FIN 鰭量級 (26公斤以上而不超過29公斤)',
        'FLY 蠅量級 (29公斤以上而不超過33公斤)',
        'BANTAM 雛量級 (33公斤以上而不超過37公斤)',
        'FEATHER 羽量級 (37公斤以上而不超過41公斤)',
        'LIGHT 輕量級 (41公斤以上而不超過44公斤)',
        'WELTER 沉量級 (44公斤以上而不超過47公斤)',
        'LIGHT MIDDLE 輕中量級 (47公斤以上而不超過51公斤)',
        'MIDDLE 中量級 (51公斤以上而不超過55公斤)',
        'LIGHT HEAVY 輕重量級 (55公斤以上而不超過59公斤)',
        'HEAVY 重量級 (59公斤以上)'
      ]
    };

    // 品勢級別劃分
    const poomsaeDivisions = {
      '男 Male': {
        '2018-2019': '男童A組 Boys Group A 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)',
        '2016-2017': '男童B組 Boys Group B 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)',
        '2014-2015': '男童C組 Boys Group C 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)',
        '2013': '男童D組 Boys Group D 12歲或以上 Age: 12 or above (2013年或以上出生者)'
      },
      '女 Female': {
        '2018-2019': '女童E組 Girls Group E 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)',
        '2016-2017': '女童F組 Girls Group F 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)',
        '2014-2015': '女童G組 Girls Group G 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)',
        '2013': '女童H組 Girls Group H 12歲或以上 Age: 12 or above (2013年或之前出生者)'
      }
    };

    // 參賽品勢
    const poomsaeEvents = {
      '男童A組 Boys Group A 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)': {
        '1-2': 'A1M 男童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'A2M 男童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'A3M 男童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'A4M 男童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'A5M 男童品段 - 品一、品二 - 高麗',
        '11': 'A6M 男童品段 - 品三或以上 - 高麗'
      },
      '男童B組 Boys Group B 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)': {
        '1-2': 'B1M 男童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'B2M 男童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'B3M 男童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'B4M 男童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'B5M 男童品段 - 品一、品二 - 高麗',
        '11': 'B6M 男童品段 - 品三或以上 - 高麗'
      },
      '男童C組 Boys Group C 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)': {
        '1-2': 'C1M 男童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'C2M 男童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'C3M 男童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'C4M 男童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'C5M 男童品段 - 品一、品二 - 高麗',
        '11': 'C6M 男童品段 - 品三或以上 - 高麗'
      },
      '男童D組 Boys Group D 12歲或以上 Age: 12 or above (2013年或以上出生者)': {
        '1-2': 'D1M 男童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'D2M 男童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'D3M 男童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'D4M 男童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'D5M 男童品段 - 品一、品二 - 高麗',
        '11': 'D6M 男童品段 - 品三或以上 - 高麗'
      },
      '女童E組 Girls Group E 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)': {
        '1-2': 'E1F 女童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'E2F 女童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'E3F 女童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'E4F 女童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'E5F 女童品段 - 品一、品二 - 高麗',
        '11': 'E6F 女童品段 - 品三或以上 - 高麗'
      },
      '女童F組 Girls Group F 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)': {
        '1-2': 'F1F 女童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'F2F 女童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'F3F 女童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'F4F 女童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'F5F 女童品段 - 品一、品二 - 高麗',
        '11': 'F6F 女童品段 - 品三或以上 - 高麗'
      },
      '女童G組 Girls Group G 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)': {
        '1-2': 'G1F 女童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'G2F 女童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'G3F 女童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'G4F 女童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'G5F 女童品段 - 品一、品二 - 高麗',
        '11': 'G6F 女童品段 - 品三或以上 - 高麗'
      },
      '女童H組 Girls Group H 12歲或以上 Age: 12 or above (2013年或之前出生者)': {
        '1-2': 'H1F 女童色帶 - 黃、黃綠 - 太極1',
        '3-4': 'H2F 女童色帶 - 綠、綠藍 - 太極3',
        '5-6': 'H3F 女童色帶 - 藍、藍紅 - 太極5',
        '7-8': 'H4F 女童色帶 - 紅、紅黑 - 太極7',
        '9-10': 'H5F 女童品段 - 品一、品二 - 高麗',
        '11': 'H6F 女童品段 - 品三或以上 - 高麗'
      }
    };

    // 表單驗證與提交
    function submitForm() {
      const confirmModal = document.getElementById('confirmModal');
      const form = document.getElementById('registrationForm');
      const schoolNameInput = document.getElementById('schoolName');
      const studentIdInput = document.getElementById('studentId');
      const affiliationInput = document.getElementById('affiliation');
      const membershipNumberInput = document.getElementById('membershipNumber');
      const chineseNameInput = document.getElementById('chineseName');
      const englishNameInput = document.getElementById('englishName');
      const birthYearSelect = document.getElementById('birthYear');
      const birthMonthSelect = document.getElementById('birthMonth');
      const birthDaySelect = document.getElementById('birthDay');
      const genderRadios = document.getElementsByName('entry.1294289670');
      const phoneInput = document.getElementById('phone');
      const beltLevelSelect = document.getElementById('beltLevel');
      const eventRadios = document.getElementsByName('entry.629960054');
      const heightInput = document.getElementById('height');
      const weightInput = document.getElementById('weight');
      const kyorugiDivisionSelect = document.getElementById('kyorugiDivision');
      const weightClassSelect = document.getElementById('weightClass');
      const poomsaeDivisionSelect = document.getElementById('poomsaeDivision');
      const poomsaeEventSelect = document.getElementById('poomsaeEvent');

      let isValid = true;
      document.querySelectorAll('.error').forEach(error => error.style.display = 'none');

      // 設置日期輸入值
      const birthDateInput = document.getElementById('birthDate');
      if (birthYearSelect.value && birthMonthSelect.value && birthDaySelect.value) {
        birthDateInput.value = `${birthYearSelect.value}-${birthMonthSelect.value.toString().padStart(2, '0')}-${birthDaySelect.value.toString().padStart(2, '0')}`;
      } else {
        birthDateInput.value = '';
      }

      // 檢查是否為 "test" 模式
      const isTestMode = schoolNameInput.value.toLowerCase().includes('test');

      // 驗證必填字段
      if (!isTestMode) {
        if (!schoolNameInput.value.trim()) {
          document.getElementById('schoolNameError').style.display = 'block';
          isValid = false;
        }
        if (!studentIdInput.value.trim()) {
          document.getElementById('studentIdError').style.display = 'block';
          isValid = false;
        }
        if (!affiliationInput.value.trim()) {
          document.getElementById('affiliationError').style.display = 'block';
          isValid = false;
        }
        if (!membershipNumberInput.value.trim()) {
          document.getElementById('membershipNumberError').style.display = 'block';
          isValid = false;
        }
        if (!chineseNameInput.value.trim()) {
          document.getElementById('chineseNameError').style.display = 'block';
          isValid = false;
        }
        if (!englishNameInput.value.trim()) {
          document.getElementById('englishNameError').style.display = 'block';
          isValid = false;
        }
        if (!birthDateInput.value) {
          document.getElementById('birthDateError').style.display = 'block';
          isValid = false;
        }
        if (!Array.from(genderRadios).some(radio => radio.checked)) {
          document.getElementById('genderError').style.display = 'block';
          isValid = false;
        }
        if (!phoneInput.value.match(/^\d{8}$/)) {
          document.getElementById('phoneError').style.display = 'block';
          isValid = false;
        }
        if (!beltLevelSelect.value) {
          document.getElementById('beltLevelError').style.display = 'block';
          isValid = false;
        }
        if (!Array.from(eventRadios).some(radio => radio.checked)) {
          document.getElementById('eventError').style.display = 'block';
          isValid = false;
        }
        const selectedEvent = Array.from(eventRadios).find(radio => radio.checked)?.value;
        if (selectedEvent && selectedEvent.includes('搏擊')) {
          if (!heightInput.value || heightInput.value <= 0) {
            document.getElementById('heightError').style.display = 'block';
            isValid = false;
          }
          if (!weightInput.value || weightInput.value <= 0) {
            document.getElementById('weightError').style.display = 'block';
            isValid = false;
          }
          if (!kyorugiDivisionSelect.value) {
            document.getElementById('kyorugiDivisionError').style.display = 'block';
            isValid = false;
          }
          if (!weightClassSelect.value) {
            document.getElementById('weightClassError').style.display = 'block';
            isValid = false;
          }
        }
        if (selectedEvent && selectedEvent.includes('品勢')) {
          if (!poomsaeDivisionSelect.value) {
            document.getElementById('poomsaeDivisionError').style.display = 'block';
            isValid = false;
          }
          if (!poomsaeEventSelect.value) {
            document.getElementById('poomsaeEventError').style.display = 'block';
            isValid = false;
          }
        }
      }

      // 顯示確認模態框
      if (isValid || isTestMode) {
        console.log('驗證通過，顯示確認模態框');
        document.getElementById('confirmSchoolName').textContent = schoolNameInput.value || '未填寫';
        document.getElementById('confirmStudentId').textContent = studentIdInput.value || '未填寫';
        document.getElementById('confirmAffiliation').textContent = affiliationInput.value || '未填寫';
        document.getElementById('confirmMembershipNumber').textContent = membershipNumberInput.value || '未填寫';
        document.getElementById('confirmChineseName').textContent = chineseNameInput.value || '未填寫';
        document.getElementById('confirmEnglishName').textContent = englishNameInput.value || '未填寫';
        document.getElementById('confirmBirthDate').textContent = birthDateInput.value || '未填寫';
        document.getElementById('confirmGender').textContent = Array.from(genderRadios).find(radio => radio.checked)?.value || '未選擇';
        document.getElementById('confirmPhone').textContent = phoneInput.value || '未填寫';
        document.getElementById('confirmBeltLevel').textContent = beltLevelSelect.value || '未選擇';
        const selectedEvent = Array.from(eventRadios).find(radio => radio.checked)?.value;
        document.getElementById('confirmEvent').textContent = selectedEvent || '未選擇';
        document.getElementById('kyorugiFields').style.display = (selectedEvent && selectedEvent.includes('搏擊')) ? 'block' : 'none';
        document.getElementById('confirmHeight').textContent = heightInput.value || '未填寫';
        document.getElementById('confirmWeight').textContent = weightInput.value || '未填寫';
        document.getElementById('confirmKyorugiDivision').textContent = kyorugiDivisionSelect.value || '未選擇';
        document.getElementById('confirmWeightClass').textContent = weightClassSelect.value || '未選擇';
        document.getElementById('poomsaeFields').style.display = (selectedEvent && selectedEvent.includes('品勢')) ? 'block' : 'none';
        document.getElementById('confirmPoomsaeDivision').textContent = poomsaeDivisionSelect.value || '未選擇';
        document.getElementById('confirmPoomsaeEvent').textContent = poomsaeEventSelect.value || '未選擇';

        confirmModal.style.display = 'flex';
      } else {
        console.log('驗證失敗，未顯示確認模態框');
      }
    }

    function cancelSubmission() {
      console.log('取消提交，關閉確認模態框');
      document.getElementById('confirmModal').style.display = 'none';
    }

    async function confirmSubmission() {
      console.log('確認提交，準備發送表單到 Google Forms');
      const confirmModal = document.getElementById('confirmModal');
      const form = document.getElementById('registrationForm');
      const formContainer = document.getElementById('mainForm');
      const thankYouPage = document.getElementById('thankYouPage');
      const selectedEvent = Array.from(document.getElementsByName('entry.629960054')).find(radio => radio.checked)?.value;
      const formData = new FormData(form);

      // 根據參賽項目篩選提交資料
      if (selectedEvent === '搏擊') {
        formData.delete('entry.1721761818'); // 品勢級別劃分
        formData.delete('entry.1921234097'); // 參賽品勢
      } else if (selectedEvent === '品勢') {
        formData.delete('entry.703788026'); // 高度
        formData.delete('entry.1666612578'); // 重量
        formData.delete('entry.1924363147'); // 搏擊級別劃分
        formData.delete('entry.1084612574'); // 搏擊量級
      }

      // 移除日期子字段，僅保留完整的出生日期
      formData.delete('entry.71284989_year');
      formData.delete('entry.71284989_month');
      formData.delete('entry.71284989_day');

      try {
        // 輸出提交的數據以便調試
        console.log('提交的表單數據：');
        for (let [key, value] of formData.entries()) {
          console.log(`${key}: ${value}`);
        }

        // 向 Google Forms 發送 POST 請求
        const response = await fetch('https://docs.google.com/forms/d/e/1FAIpQLSfwydgGIL-COHGvXH8dMRos0JeF8c3Fy6hwfLltRdw6YOjlVQ/formResponse', {
          method: 'POST',
          mode: 'no-cors',
          body: formData
        });

        console.log('表單提交請求已發送');
        confirmModal.style.display = 'none';
        formContainer.style.display = 'none';
        thankYouPage.style.display = 'block';
      } catch (error) {
        console.error('表單提交失敗:', error);
        alert('表單提交失敗，請檢查控制台日誌或聯繫管理員。');
      }
    }

    function resetForm() {
      const form = document.getElementById('registrationForm');
      form.reset();
      document.querySelectorAll('.error').forEach(error => error.style.display = 'none');
      document.getElementById('kyorugiDivision').innerHTML = '<option value="">請選擇搏擊級別</option>';
      document.getElementById('weightClass').innerHTML = '<option value="">請選擇搏擊量級</option>';
      document.getElementById('poomsaeDivision').innerHTML = '<option value="">請選擇品勢級別</option>';
      document.getElementById('poomsaeEvent').innerHTML = '<option value="">請選擇參賽品勢</option>';
      updateEventOptions();
    }

    function restartForm() {
      console.log('重新報名，顯示表單');
      const thankYouPage = document.getElementById('thankYouPage');
      const formContainer = document.getElementById('mainForm');
      thankYouPage.style.display = 'none';
      formContainer.style.display = 'block';
      resetForm();
    }

    // 等待 DOM 完全加載
    document.addEventListener('DOMContentLoaded', () => {
      // 動態生成年份、月份和日期選項
      function populateDateSelects(yearSelectId, monthSelectId, daySelectId, hiddenInputId) {
        const yearSelect = document.getElementById(yearSelectId);
        const monthSelect = document.getElementById(monthSelectId);
        const daySelect = document.getElementById(daySelectId);
        const hiddenInput = document.getElementById(hiddenInputId);

        // 生成年份選項 (2019 到 2005)
        for (let year = 2019; year >= 2005; year--) {
          let option = document.createElement('option');
          option.value = year;
          option.text = year;
          yearSelect.appendChild(option);
        }

        // 生成月份選項 (1 到 12)
        for (let month = 1; month <= 12; month++) {
          let option = document.createElement('option');
          option.value = month;
          option.text = month.toString().padStart(2, '0');
          monthSelect.appendChild(option);
        }

        function isLeapYear(year) {
          return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
        }

        function updateDays() {
          const year = parseInt(yearSelect.value) || 2019;
          const month = parseInt(monthSelect.value) || 1;
          const prevDay = daySelect.value;
          daySelect.innerHTML = '<option value="">日</option>';
          if (year && month) {
            const daysInMonth = [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month - 1];
            for (let day = 1; day <= daysInMonth; day++) {
              let option = document.createElement('option');
              option.value = day;
              option.text = day.toString().padStart(2, '0');
              daySelect.appendChild(option);
            }
            // 保留之前選擇的日期，如果新月份有該日期
            if (prevDay && parseInt(prevDay) <= daysInMonth) {
              daySelect.value = prevDay;
            }
          }
          updateHiddenInput();
        }

        function updateHiddenInput() {
          const year = yearSelect.value;
          const month = monthSelect.value;
          const day = daySelect.value;
          if (year && month && day) {
            hiddenInput.value = `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
          } else {
            hiddenInput.value = '';
          }
          updateEventOptions();
          updateKyorugiDivision();
          updatePoomsaeDivision();
        }

        // 綁定事件監聽器
        yearSelect.addEventListener('change', () => {
          updateDays();
          validateDate(yearSelectId, monthSelectId, daySelectId);
        });
        monthSelect.addEventListener('change', () => {
          updateDays();
          validateDate(yearSelectId, monthSelectId, daySelectId);
        });
        daySelect.addEventListener('change', () => {
          updateHiddenInput();
          validateDate(yearSelectId, monthSelectId, daySelectId);
        });

        // 初始化日期選項
        updateDays();
      }

      // 日期驗證
      function validateDate(yearSelectId, monthSelectId, daySelectId) {
        const yearSelect = document.getElementById(yearSelectId);
        const monthSelect = document.getElementById(monthSelectId);
        const daySelect = document.getElementById(daySelectId);
        const errorElement = document.getElementById(`${yearSelectId.replace('Year', '')}Error`);
        if (errorElement) {
          if (yearSelect.value && monthSelect.value && daySelect.value) {
            const selectedDate = new Date(parseInt(yearSelect.value), parseInt(monthSelect.value) - 1, parseInt(daySelect.value));
            if (!isNaN(selectedDate)) {
              errorElement.style.display = 'none';
              return true;
            } else {
              errorElement.style.display = 'block';
              return false;
            }
          }
          errorElement.style.display = 'none';
        }
        return true;
      }

      // 初始化日期選項
      populateDateSelects('birthYear', 'birthMonth', 'birthDay', 'birthDate');

      // 更新參賽項目選項
      function updateEventOptions() {
        const birthYear = parseInt(document.getElementById('birthYear').value);
        const beltLevel = document.getElementById('beltLevel').value;
        const kyorugiRadio = document.getElementById('kyorugiRadio');
        const bothRadio = document.getElementById('bothRadio');
        const kyorugiLabel = kyorugiRadio.parentElement;
        const bothLabel = bothRadio.parentElement;

        const eligibleForKyorugi = birthYear >= 2011 && birthYear <= 2017 && 
          ['綠帶 Green Belt', '綠藍帶 Green-Blue Belt', '藍帶 Blue Belt', '藍紅帶 Blue-Red Belt', '紅帶 Red Belt', '紅黑帶 Red-Black Belt'].includes(beltLevel);

        kyorugiRadio.disabled = !eligibleForKyorugi;
        bothRadio.disabled = !eligibleForKyorugi;
        kyorugiLabel.classList.toggle('disabled', !eligibleForKyorugi);
        bothLabel.classList.toggle('disabled', !eligibleForKyorugi);

        updateEventFields();
      }

      // 更新搏擊和品勢相關欄位
      function updateEventFields() {
        const selectedEvent = Array.from(document.getElementsByName('entry.629960054')).find(radio => radio.checked)?.value;
        const heightInput = document.getElementById('height');
        const weightInput = document.getElementById('weight');
        const kyorugiDivisionSelect = document.getElementById('kyorugiDivision');
        const weightClassSelect = document.getElementById('weightClass');
        const poomsaeDivisionSelect = document.getElementById('poomsaeDivision');
        const poomsaeEventSelect = document.getElementById('poomsaeEvent');

        heightInput.disabled = !(selectedEvent && selectedEvent.includes('搏擊'));
        weightInput.disabled = !(selectedEvent && selectedEvent.includes('搏擊'));
        kyorugiDivisionSelect.disabled = !(selectedEvent && selectedEvent.includes('搏擊'));
        weightClassSelect.disabled = !(selectedEvent && selectedEvent.includes('搏擊'));
        poomsaeDivisionSelect.disabled = !(selectedEvent && selectedEvent.includes('品勢'));
        poomsaeEventSelect.disabled = !(selectedEvent && selectedEvent.includes('品勢'));

        updateKyorugiDivision();
        updateWeightClass();
        updatePoomsaeDivision();
        updatePoomsaeEvent();
      }

      // 更新搏擊級別劃分
      function updateKyorugiDivision() {
        const birthYear = parseInt(document.getElementById('birthYear').value);
        const gender = Array.from(document.getElementsByName('entry.1294289670')).find(radio => radio.checked)?.value;
        const kyorugiDivisionSelect = document.getElementById('kyorugiDivision');
        kyorugiDivisionSelect.innerHTML = '<option value="">請選擇搏擊級別</option>';

        if (birthYear && gender && kyorugiDivisions[gender]) {
          let divisionKey;
          if (birthYear >= 2015 && birthYear <= 2017) {
            divisionKey = '2015-2017';
          } else if (birthYear >= 2013 && birthYear <= 2014) {
            divisionKey = '2013-2014';
          } else if (birthYear >= 2011 && birthYear <= 2012) {
            divisionKey = '2011-2012';
          }
          if (divisionKey && kyorugiDivisions[gender][divisionKey]) {
            const option = document.createElement('option');
            option.value = kyorugiDivisions[gender][divisionKey];
            option.text = kyorugiDivisions[gender][divisionKey];
            kyorugiDivisionSelect.appendChild(option);
            kyorugiDivisionSelect.value = kyorugiDivisions[gender][divisionKey];
          }
        }
        updateWeightClass();
      }

      // 更新搏擊量級
      function updateWeightClass() {
        const kyorugiDivision = document.getElementById('kyorugiDivision').value;
        const weightClassSelect = document.getElementById('weightClass');
        weightClassSelect.innerHTML = '<option value="">請選擇搏擊量級</option>';

        if (kyorugiDivision && weightClasses[kyorugiDivision]) {
          weightClasses[kyorugiDivision].forEach(weightClass => {
            const option = document.createElement('option');
            option.value = weightClass;
            option.text = weightClass;
            weightClassSelect.appendChild(option);
          });
        }
      }

      // 更新品勢級別劃分
      function updatePoomsaeDivision() {
        const birthYear = parseInt(document.getElementById('birthYear').value);
        const gender = Array.from(document.getElementsByName('entry.1294289670')).find(radio => radio.checked)?.value;
        const poomsaeDivisionSelect = document.getElementById('poomsaeDivision');
        poomsaeDivisionSelect.innerHTML = '<option value="">請選擇品勢級別</option>';

        if (birthYear && gender && poomsaeDivisions[gender]) {
          let divisionKey;
          if (birthYear >= 2018 && birthYear <= 2019) {
            divisionKey = '2018-2019';
          } else if (birthYear >= 2016 && birthYear <= 2017) {
            divisionKey = '2016-2017';
          } else if (birthYear >= 2014 && birthYear <= 2015) {
            divisionKey = '2014-2015';
          } else if (birthYear <= 2013) {
            divisionKey = '2013';
          }
          if (divisionKey && poomsaeDivisions[gender][divisionKey]) {
            const option = document.createElement('option');
            option.value = poomsaeDivisions[gender][divisionKey];
            option.text = poomsaeDivisions[gender][divisionKey];
            poomsaeDivisionSelect.appendChild(option);
            poomsaeDivisionSelect.value = poomsaeDivisions[gender][divisionKey];
          }
        }
        updatePoomsaeEvent();
      }

      // 更新參賽品勢
      function updatePoomsaeEvent() {
        const poomsaeDivision = document.getElementById('poomsaeDivision').value;
        const beltLevel = document.getElementById('beltLevel').value;
        const poomsaeEventSelect = document.getElementById('poomsaeEvent');
        poomsaeEventSelect.innerHTML = '<option value="">請選擇參賽品勢</option>';

        if (poomsaeDivision && beltLevel && poomsaeEvents[poomsaeDivision]) {
          let beltIndex;
          if (['黃帶 Yellow Belt', '黃綠帶 Yellow-Green Belt'].includes(beltLevel)) {
            beltIndex = '1-2';
          } else if (['綠帶 Green Belt', '綠藍帶 Green-Blue Belt'].includes(beltLevel)) {
            beltIndex = '3-4';
          } else if (['藍帶 Blue Belt', '藍紅帶 Blue-Red Belt'].includes(beltLevel)) {
            beltIndex = '5-6';
          } else if (['紅帶 Red Belt', '紅黑帶 Red-Black Belt'].includes(beltLevel)) {
            beltIndex = '7-8';
          } else if (['品一 Poom 1', '品二 Poom 2'].includes(beltLevel)) {
            beltIndex = '9-10';
          } else if (beltLevel === '品三或上 Poom 3 or above') {
            beltIndex = '11';
          }
          if (beltIndex && poomsaeEvents[poomsaeDivision][beltIndex]) {
            const option = document.createElement('option');
            option.value = poomsaeEvents[poomsaeDivision][beltIndex];
            option.text = poomsaeEvents[poomsaeDivision][beltIndex];
            poomsaeEventSelect.appendChild(option);
            poomsaeEventSelect.value = poomsaeEvents[poomsaeDivision][beltIndex];
          }
        }
      }

      // 監聽事件
      document.getElementById('birthYear').addEventListener('change', updateEventOptions);
      document.getElementById('beltLevel').addEventListener('change', updateEventOptions);
      document.querySelectorAll('input[name="entry.629960054"]').forEach(radio => {
        radio.addEventListener('change', updateEventFields);
      });
      document.querySelectorAll('input[name="entry.1294289670"]').forEach(radio => {
        radio.addEventListener('change', () => {
          updateKyorugiDivision();
          updatePoomsaeDivision();
        });
      });
      document.getElementById('kyorugiDivision').addEventListener('change', updateWeightClass);
      document.getElementById('poomsaeDivision').addEventListener('change', updatePoomsaeEvent);
      document.getElementById('beltLevel').addEventListener('change', updatePoomsaeEvent);
    });
  </script>
</body>
</html>

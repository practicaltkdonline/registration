<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025香港小學跆拳道隊際賽 Hong Kong Primary School Taekwondo Competition 2025</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', Arial, sans-serif;
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: linear-gradient(135deg, #f0f4f8, #e0e8f0);
      color: #333;
      line-height: 1.6;
    }
    .form-container {
      background: white;
      padding: 32px;
      border-radius: 16px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease;
    }
    .form-container:hover {
      transform: translateY(-2px);
    }
    .form-header {
      text-align: center;
      margin-bottom: 32px;
      padding-bottom: 16px;
      border-bottom: 1px solid #e0e0e0;
    }
    .form-header h1 {
      font-size: 28px;
      font-weight: 700;
      color: #2c3e50;
      margin: 0;
    }
    .form-header h2 {
      font-size: 20px;
      font-weight: 500;
      color: #7f8c8d;
      margin-top: 8px;
    }
    .form-group {
      margin-bottom: 24px;
      padding: 16px;
      border-radius: 12px;
      background: #fff;
      transition: background 0.3s ease;
    }
    .form-group:nth-child(odd) {
      background: #f9fafb;
    }
    .form-group:nth-child(even) {
      background: #ffffff;
    }
    .form-group:hover {
      background: #f5f7fa;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      font-size: 16px;
      color: #34495e;
    }
    input, select, button {
      width: 100%;
      padding: 12px;
      border: 1px solid #d3d9e0;
      border-radius: 8px;
      box-sizing: border-box;
      font-size: 16px;
      background: #ffffff;
      transition: border-color 0.3s, box-shadow 0.3s, background 0.3s;
    }
    input:focus, select:focus, button:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 8px rgba(52, 152, 219, 0.3);
      background: #f8fcff;
    }
    input:disabled, select:disabled {
      background-color: #f5f7fa;
      pointer-events: none;
    }
    .date-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .date-group select {
      width: 120px;
      max-width: 100%;
    }
    .date-group select#birthYear {
      width: 160px;
      max-width: 100%;
    }
    .date-group span {
      font-size: 16px;
      color: #34495e;
    }
    .category-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 8px 0;
    }
    .category-group label {
      display: flex;
      align-items: center;
      font-weight: normal;
      font-size: 16px;
      color: #2c3e50;
    }
    .category-group input[type="radio"] {
      width: auto;
      margin-right: 12px;
    }
    .category-group input[type="radio"]:disabled + span {
      color: #b0b0b0;
    }
    .error {
      color: #e74c3c;
      font-size: 14px;
      margin-top: 6px;
      display: none;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background-color: white;
      padding: 32px;
      border-radius: 16px;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      max-height: 80vh;
    }
    .modal-scroll {
      overflow-y: auto;
      flex-grow: 1;
      margin-bottom: 20px;
      padding-right: 10px;
    }
    .modal-content p {
      font-size: 16px;
      margin: 12px 0;
      color: #2c3e50;
    }
    button.confirm, button.return-button {
      background: linear-gradient(90deg, #3498db, #2980b9);
      color: white;
      border: none;
      cursor: pointer;
      padding: 12px;
      border-radius: 8px;
      transition: background 0.3s, transform 0.2s;
    }
    button.confirm:hover, button.return-button:hover {
      background: linear-gradient(90deg, #2980b9, #1f6b9e);
      transform: translateY(-2px);
    }
    button.cancel {
      background: #ecf0f1;
      color: #7f8c8d;
      padding: 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    button.cancel:hover {
      background: #dfe6e9;
      transform: translateY(-2px);
    }
    #submitBtn {
      background: linear-gradient(90deg, #2ecc71, #27ae60);
      color: white;
      margin-top: 20px;
      padding: 14px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
      width: 100%;
    }
    #submitBtn:hover {
      background: linear-gradient(90deg, #27ae60, #219653);
      transform: translateY(-2px);
    }
    #thankYouPage {
      display: none;
      background: white;
      padding: 32px;
      border-radius: 16px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      text-align: center;
      transition: transform 0.2s ease;
    }
    #thankYouPage:hover {
      transform: translateY(-2px);
    }
    #thankYouPage h2 {
      font-size: 24px;
      margin-bottom: 16px;
      color: #2c3e50;
    }
    #thankYouPage p {
      font-size: 16px;
      margin: 16px 0;
      color: #27ae60;
    }
    #affiliation {
      position: relative;
    }
    #affiliationSearch {
      margin-bottom: 8px;
    }
    @media (max-width: 600px) {
      .form-container, #thankYouPage {
        padding: 20px;
        margin: 10px;
      }
      .form-header h1 {
        font-size: 22px;
      }
      .form-header h2 {
        font-size: 16px;
      }
      .form-group {
        padding: 12px;
      }
      input, select, button {
        padding: 10px;
        font-size: 14px;
      }
      .date-group {
        flex-direction: column;
        align-items: stretch;
        gap: 6px;
      }
      .date-group select {
        width: 100%;
      }
      .date-group select#birthYear {
        width: 100%;
      }
      .modal-content {
        width: 95%;
        padding: 20px;
        max-height: 85vh;
      }
      .modal-content p {
        font-size: 14px;
      }
      button.confirm, button.cancel, button.return-button, #submitBtn {
        padding: 10px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="form-container" id="mainForm">
    <div class="form-header">
      <h1>2025香港小學跆拳道隊際賽</h1>
      <h1>Hong Kong Primary School Taekwondo Competition 2025</h1>
      <h2>家長用報名表</h2>
    </div>
    <form id="registrationForm">
      <div class="form-group">
        <label>現讀小學 *</label>
        <input type="text" id="schoolName" name="entry.1714227241" placeholder="以學生證上的中文名稱為準" required>
        <span id="schoolNameError" class="error">請輸入現讀小學</span>
      </div>
      <div class="form-group">
        <label>學生證編號 *</label>
        <input type="text" id="studentId" name="entry.1045318375" required>
        <span id="studentIdError" class="error">請輸入學生證編號</span>
      </div>
      <div class="form-group">
        <label>屬會名稱 *</label>
        <input type="text" id="affiliationSearch" placeholder="搜尋屬會名稱...">
        <select id="affiliation" name="entry.1597491054" required>
          <option value="">請選擇屬會</option>
          <option value="香港仔跆拳道會 Aberdeen TKD Club">香港仔跆拳道會 Aberdeen TKD Club</option>
          <option value="技擊跆拳道會 Advanced TKD Association">技擊跆拳道會 Advanced TKD Association</option>
          <option value="躍駿跆拳道會 Attack TKD Association">躍駿跆拳道會 Attack TKD Association</option>
          <option value="青雲跆拳道會 Ching Wan TKD Association">青雲跆拳道會 Ching Wan TKD Association</option>
          <option value="精英跆拳道會 Ching Ying TKD Union">精英跆拳道會 Ching Ying TKD Union</option>
          <option value="金柏跆拳道協會 Combat TKD Association">金柏跆拳道協會 Combat TKD Association</option>
          <option value="香港跆拳道東龍會 Eastern Dragon TKD Federation HK">香港跆拳道東龍會 Eastern Dragon TKD Federation HK</option>
          <option value="勵志跆拳道總會 Encouragement TKD Association">勵志跆拳道總會 Encouragement TKD Association</option>
          <option value="香港智道跆拳總會 HK Chido TKD Association">香港智道跆拳總會 HK Chido TKD Association</option>
          <option value="香港啟聯跆拳道協會 HK Kai Luen TKD Association">香港啟聯跆拳道協會 HK Kai Luen TKD Association</option>
          <option value="香港尼泊爾跆拳道會 HK Nepalese TKD Club">香港尼泊爾跆拳道會 HK Nepalese TKD Club</option>
          <option value="香港實用跆拳道協會 HK Practical TKD Association">香港實用跆拳道協會 HK Practical TKD Association</option>
          <option value="香港跆拳道振武館 HK TKD Chun Mo Kwan">香港跆拳道振武館 HK TKD Chun Mo Kwan</option>
          <option value="香港跆拳道勵進會 HK TKD Action Association">香港跆拳道勵進會 HK TKD Action Association</option>
          <option value="香港跆拳道勵誠會 HK TKD Active Association">香港跆拳道勵誠會 HK TKD Active Association</option>
          <option value="香港跆拳道勵輝會 HK TKD Actual Association">香港跆拳道勵輝會 HK TKD Actual Association</option>
          <option value="香港中道跆拳道會 HK Chong Do TKD Association">香港中道跆拳道會 HK Chong Do TKD Association</option>
          <option value="香港跆拳道青濤館 HK TKD Chung Do Kwan">香港跆拳道青濤館 HK TKD Chung Do Kwan</option>
          <option value="香港跆拳道正道館 HK TKD Jung Do Kwan">香港跆拳道正道館 HK TKD Jung Do Kwan</option>
          <option value="香港跆拳道正心館 HK TKD Jung Sim Kwan">香港跆拳道正心館 HK TKD Jung Sim Kwan</option>
          <option value="香港聯盟跆拳道協會 HK United TKD Association">香港聯盟跆拳道協會 HK United TKD Association</option>
          <option value="跆拳道明道會 TKD Bright Way Association">跆拳道明道會 TKD Bright Way Association</option>
          <option value="漢道跆拳道館 Hon Do TKD Kwan">漢道跆拳道館 Hon Do TKD Kwan</option>
          <option value="國際跆拳道香港總會 International TKD HK Association">國際跆拳道香港總會 International TKD HK Association</option>
          <option value="韓國跆拳道青道館 Korea TKD Cheung Do Kwan">韓國跆拳道青道館 Korea TKD Cheung Do Kwan</option>
          <option value="樂華跆拳道會 Lok Wah TKD Club">樂華跆拳道會 Lok Wah TKD Club</option>
          <option value="銘英跆拳道會 Main Pioneer TKD Association">銘英跆拳道會 Main Pioneer TKD Association</option>
          <option value="跆拳道武德會 Moo Duk TKD Hae">跆拳道武德會 Moo Duk TKD Hae</option>
          <option value="伍華跆拳道會 Ng Wah TKD Club">伍華跆拳道會 Ng Wah TKD Club</option>
          <option value="毅武聯盟跆拳道 Ngai Mo Alliance TKD">毅武聯盟跆拳道 Ngai Mo Alliance TKD</option>
          <option value="香港警察跆拳道會 HK Police TKD Club">香港警察跆拳道會 HK Police TKD Club</option>
          <option value="香港跆拳道國藝會 Potential TKD HK Association">香港跆拳道國藝會 Potential TKD HK Association</option>
          <option value="尚武聯跆拳道會 Sheung Mo Luen TKD Association">尚武聯跆拳道會 Sheung Mo Luen TKD Association</option>
          <option value="捷擊跆拳道館 TKD Jet Kick Kwan">捷擊跆拳道館 TKD Jet Kick Kwan</option>
          <option value="跆拳道吾道會體育館 TKD Oh Do Hae Gymnasium">跆拳道吾道會體育館 TKD Oh Do Hae Gymnasium</option>
          <option value="香港胡氏跆拳道會 Wu’s TKD HK Association">香港胡氏跆拳道會 Wu’s TKD HK Association</option>
          <option value="正武會跆拳道協會 Zheng Wu TKD Association">正武會跆拳道協會 Zheng Wu TKD Association</option>
          <option value="香港發景跆拳道會 Hong Kong Greatview TKD Club">香港發景跆拳道會 Hong Kong Greatview TKD Club</option>
          <option value="香港跆拳道柏毅會 Hong Kong TKD Pak Ngai Association">香港跆拳道柏毅會 Hong Kong TKD Pak Ngai Association</option>
          <option value="香港跆拳道嚴濤會 Hong Kong TKD Uhm Do Club">香港跆拳道嚴濤會 Hong Kong TKD Uhm Do Club</option>
          <option value="威格跆拳道會 Warrior TKD Club">威格跆拳道會 Warrior TKD Club</option>
          <option value="金道跆拳道聯盟 The Kimdo TKD Federation">金道跆拳道聯盟 The Kimdo TKD Federation</option>
          <option value="金道一跆拳道館 Kim Do Yi TKD Kwan">金道一跆拳道館 Kim Do Yi TKD Kwan</option>
          <option value="樂武跆拳道會 Cheerful TKD Association Limited">樂武跆拳道會 Cheerful TKD Association Limited</option>
          <option value="世紀跆拳道會 H.K. Taekwondo Cosmopolitan Club">世紀跆拳道會 H.K. Taekwondo Cosmopolitan Club</option>
          <option value="燊．跆拳道館 Sun Taekwondo Club">燊．跆拳道館 Sun Taekwondo Club</option>
          <option value="香港進和跆拳道會 Hong Kong Chun Wo Taekwondo Association">香港進和跆拳道會 Hong Kong Chun Wo Taekwondo Association</option>
          <option value="香港賢薈跆拳道會 Hong Kong Ultimate Taekwondo Club">香港賢薈跆拳道會 Hong Kong Ultimate Taekwondo Club</option>
        </select>
        <span id="affiliationError" class="error">請選擇或輸入屬會名稱</span>
      </div>
      <div class="form-group">
        <label>跆協段證/色帶會員証編號 *</label>
        <input type="text" id="membershipNumber" name="entry.1820097193" required>
        <span id="membershipNumberError" class="error">請輸入會員証編號</span>
      </div>
      <div class="form-group">
        <label>中文姓名 *</label>
        <input type="text" id="chineseName" name="entry.1739837016" placeholder="如沒有請填寫英文姓名 (請以大寫字母填寫)" oninput="if (!/[\u4e00-\u9fff]/.test(this.value)) this.value = this.value.toUpperCase();" required>
        <span id="chineseNameError" class="error">請輸入中文姓名或英文姓名</span>
      </div>
      <div class="form-group">
        <label>英文姓名 *</label>
        <input type="text" id="englishName" name="entry.69039678" placeholder="請以大寫字母填寫" oninput="this.value = this.value.toUpperCase()" required>
        <span id="englishNameError" class="error">請輸入英文姓名</span>
      </div>
      <div class="form-group">
        <label>出生日期 Date of Birth YYYY-MM-DD *</label>
        <div class="date-group">
          <select id="birthYear" name="entry.71284989_year" required>
            <option value="">年</option>
          </select>
          <span>/</span>
          <select id="birthMonth" name="entry.71284989_month" required>
            <option value="">月</option>
          </select>
          <span>/</span>
          <select id="birthDay" name="entry.71284989_day" required>
            <option value="">日</option>
          </select>
        </div>
        <input type="hidden" id="birthDate" name="entry.71284989">
        <span id="birthDateError" class="error">請選擇有效的出生日期</span>
      </div>
      <div class="form-group">
        <label>性別 Gender *</label>
        <div class="category-group">
          <label><input type="radio" name="entry.1854501309" value="男 Male" required> 男 Male</label>
          <label><input type="radio" name="entry.1854501309" value="女 Female"> 女 Female</label>
        </div>
        <span id="genderError" class="error">請選擇性別</span>
      </div>
      <div class="form-group">
        <label>聯絡電話 Telephone Number *</label>
        <input type="tel" id="phone" name="entry.269558714" pattern="\d{8}" required>
        <span id="phoneError" class="error">請輸入有效的8位電話號碼</span>
      </div>
      <div class="form-group">
        <label>現有級別 Present Grade Held *</label>
        <select id="beltLevel" name="entry.274850195" required>
          <option value="">請選擇級別</option>
          <option value="黃帶 Yellow Belt">黃帶 Yellow Belt</option>
          <option value="黃綠帶 Yellow-Green Belt">黃綠帶 Yellow-Green Belt</option>
          <option value="綠帶 Green Belt">綠帶 Green Belt</option>
          <option value="綠藍帶 Green-Blue Belt">綠藍帶 Green-Blue Belt</option>
          <option value="藍帶 Blue Belt">藍帶 Blue Belt</option>
          <option value="藍紅帶 Blue-Red Belt">藍紅帶 Blue-Red Belt</option>
          <option value="紅帶 Red Belt">紅帶 Red Belt</option>
          <option value="紅黑帶 Red-Black Belt">紅黑帶 Red-Black Belt</option>
          <option value="品一 Poom 1">品一 Poom 1</option>
          <option value="品二 Poom 2">品二 Poom 2</option>
          <option value="品三或上 Poom 3 or above">品三或上 Poom 3 or above</option>
        </select>
        <span id="beltLevelError" class="error">請選擇現有級別</span>
      </div>
      <div class="form-group">
        <label>參賽項目 Event *</label>
        <div class="category-group">
          <label><input type="radio" name="entry.629960054" value="搏擊" required> 搏擊</label>
          <label><input type="radio" name="entry.629960054" value="品勢"> 品勢</label>
          <label><input type="radio" name="entry.629960054" value="搏擊及品勢"> 搏擊及品勢</label>
        </div>
        <span id="eventError" class="error">請選擇參賽項目</span>
      </div>
      <div class="form-group">
        <label>參賽者高度 Height (cm)</label>
        <input type="number" id="height" name="entry.703788026" disabled>
        <span id="heightError" class="error">請輸入有效的高度 (cm)</span>
      </div>
      <div class="form-group">
        <label>參賽者重量 Weight (kg)</label>
        <input type="number" id="weight" name="entry.1666612578" disabled>
        <span id="weightError" class="error">請輸入有效的重量 (kg)</span>
      </div>
      <div class="form-group">
        <label>搏擊級別劃分 Kyorugi Division</label>
        <select id="kyorugiDivision" name="entry.1924363147" disabled>
          <option value="">請選擇搏擊級別</option>
        </select>
        <span id="kyorugiDivisionError" class="error">請選擇搏擊級別劃分</span>
      </div>
      <div class="form-group">
        <label>搏擊量級 Weight Category</label>
        <select id="weightCategory" name="entry.1084612574" disabled>
          <option value="">請選擇量級</option>
        </select>
        <span id="weightCategoryError" class="error">請選擇搏擊量級</span>
      </div>
      <div class="form-group">
        <label>品勢級別劃分 Poomsae Division</label>
        <select id="poomsaeDivision" name="entry.1721761818" disabled>
          <option value="">請選擇品勢級別</option>
        </select>
        <span id="poomsaeDivisionError" class="error">請選擇品勢級別劃分</span>
      </div>
      <div class="form-group">
        <label>參賽品勢 Poomsae</label>
        <select id="poomsae" name="entry.1921234097" disabled>
          <option value="">請選擇品勢</option>
        </select>
        <span id="poomsaeError" class="error">請選擇參賽品勢</span>
      </div>
      <button type="button" id="submitBtn" onclick="submitForm()">提交表單</button>
    </form>
  </div>

  <div id="confirmModal" class="modal">
    <div class="modal-content">
      <div class="modal-scroll">
        <h2>請確認您的報名資料</h2>
        <p><strong>現讀小學：</strong> <span id="confirmSchoolName"></span></p>
        <p><strong>學生證編號：</strong> <span id="confirmStudentId"></span></p>
        <p><strong>屬會名稱：</strong> <span id="confirmAffiliation"></span></p>
        <p><strong>會員証編號：</strong> <span id="confirmMembershipNumber"></span></p>
        <p><strong>中文姓名：</strong> <span id="confirmChineseName"></span></p>
        <p><strong>英文姓名：</strong> <span id="confirmEnglishName"></span></p>
        <p><strong>出生日期：</strong> <span id="confirmBirthDate"></span></p>
        <p><strong>性別：</strong> <span id="confirmGender"></span></p>
        <p><strong>聯絡電話：</strong> <span id="confirmPhone"></span></p>
        <p><strong>現有級別：</strong> <span id="confirmBeltLevel"></span></p>
        <p><strong>參賽項目：</strong> <span id="confirmEvent"></span></p>
        <p><strong>參賽者高度：</strong> <span id="confirmHeight"></span></p>
        <p><strong>參賽者重量：</strong> <span id="confirmWeight"></span></p>
        <p><strong>搏擊級別劃分：</strong> <span id="confirmKyorugiDivision"></span></p>
        <p><strong>搏擊量級：</strong> <span id="confirmWeightCategory"></span></p>
        <p><strong>品勢級別劃分：</strong> <span id="confirmPoomsaeDivision"></span></p>
        <p><strong>參賽品勢：</strong> <span id="confirmPoomsae"></span></p>
      </div>
      <div style="display: flex; gap: 10px;">
        <button class="cancel" onclick="cancelSubmission()">取消</button>
        <button class="confirm" onclick="confirmSubmission()">確認提交</button>
      </div>
    </div>
  </div>

  <div id="thankYouPage">
    <h2>感謝您的報名！</h2>
    <p>確認後教練將盡快與您聯繫核對資料。</p>
    <p id="photoMessage"></p>
    <p>並將PDF最後一頁的同意書交給教練。</p>
    <button class="return-button" onclick="restartForm()">重新報名</button>
  </div>

  <script>
    // 級別映射
    const beltMapping = {
      '黃帶 Yellow Belt': '1',
      '黃綠帶 Yellow-Green Belt': '2',
      '綠帶 Green Belt': '3',
      '綠藍帶 Green-Blue Belt': '4',
      '藍帶 Blue Belt': '5',
      '藍紅帶 Blue-Red Belt': '6',
      '紅帶 Red Belt': '7',
      '紅黑帶 Red-Black Belt': '8',
      '品一 Poom 1': '9',
      '品二 Poom 2': '10',
      '品三或上 Poom 3 or above': '11'
    };

    // 搏擊級別劃分數據
    const kyorugiDivisions = {
      '男 Male': {
        '2015-2017': ['男童色帶A組 Boys Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)'],
        '2013-2014': ['男童色帶B組 Boys Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)'],
        '2011-2012': ['男童色帶C組 Boys Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)']
      },
      '女 Female': {
        '2015-2017': ['女童色帶A組 Girls Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)'],
        '2013-2014': ['女童色帶B組 Girls Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)'],
        '2011-2012': ['女童色帶C組 Girls Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)']
      }
    };

    // 搏擊量級數據
    const weightCategories = {
      '男童色帶A組 Boys Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)': [
        'FIN 鰭量級 (25公斤以上而不超過27公斤)',
        'FLY 蠅量級 (27公斤以上而不超過29公斤)',
        'BANTAM 雛量級 (29公斤以上而不超過31公斤)',
        'FEATHER 羽量級 (31公斤以上而不超過34公斤)',
        'LIGHT 輕量級 (34公斤以上而不超過37公斤)',
        'WELTER 沉量級 (37公斤以上而不超過40公斤)',
        'LIGHT MIDDLE 輕中量級 (40公斤以上而不超過43公斤)',
        'MIDDLE 中量級 (43公斤以上而不超過46公斤)',
        'LIGHT HEAVY 輕重量級 (46公斤以上而不超過49公斤)',
        'HEAVY 重量級 (49公斤以上而不超過57公斤)'
      ],
      '男童色帶B組 Boys Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)': [
        'FIN 鰭量級 (28公斤以下)',
        'FLY 蠅量級 (28公斤以上而不超過30公斤)',
        'BANTAM 雛量級 (30公斤以上而不超過32公斤)',
        'FEATHER 羽量級 (32公斤以上而不超過35公斤)',
        'LIGHT 輕量級 (35公斤以上而不超過38公斤)',
        'WELTER 沉量級 (38公斤以上而不超過41公斤)',
        'LIGHT MIDDLE 輕中量級 (41公斤以上而不超過44公斤)',
        'MIDDLE 中量級 (44公斤以上而不超過47公斤)',
        'LIGHT HEAVY 輕重量級 (47公斤以上而不超過50公斤)',
        'HEAVY 重量級 (50公斤以上而不超過58公斤)'
      ],
      '男童色帶C組 Boys Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)': [
        'FIN 鰭量級 (31公斤以下)',
        'FLY 蠅量級 (31公斤以上而不超過34公斤)',
        'BANTAM 雛量級 (34公斤以上而不超過37公斤)',
        'FEATHER 羽量級 (37公斤以上而不超過39公斤)',
        'LIGHT 輕量級 (39公斤以上而不超過42公斤)',
        'WELTER 沉量級 (42公斤以上而不超過44公斤)',
        'LIGHT MIDDLE 輕中量級 (44公斤以上而不超過47公斤)',
        'MIDDLE 中量級 (47公斤以上而不超過50公斤)',
        'LIGHT HEAVY 輕重量級 (50公斤以上而不超過54公斤)',
        'HEAVY 重量級 (54公斤以上而不超過62公斤)'
      ],
      '女童色帶A組 Girls Color Belt Group A 8歲至10歲 Age: 8 to 10 (2015年至2017年出生者)': [
        'FIN 鰭量級 (21公斤以上而不超過24公斤)',
        'FLY 蠅量級 (24公斤以上而不超過27公斤)',
        'BANTAM 雛量級 (27公斤以上而不超過30公斤)',
        'FEATHER 羽量級 (30公斤以上而不超過33公斤)',
        'LIGHT 輕量級 (33公斤以上而不超過36公斤)',
        'WELTER 沉量級 (36公斤以上而不超過39公斤)',
        'LIGHT MIDDLE 輕中量級 (39公斤以上而不超過42公斤)',
        'MIDDLE 中量級 (42公斤以上而不超過45公斤)',
        'LIGHT HEAVY 輕重量級 (45公斤以上而不超過48公斤)',
        'HEAVY 重量級 (48公斤以上而不超過52公斤)'
      ],
      '女童色帶B組 Girls Color Belt Group B 11歲至12歲 Age: 11 to 12 (2013年至2014年出生者)': [
        'FIN 鰭量級 (22公斤以上而不超過25公斤)',
        'FLY 蠅量級 (25公斤以上而不超過28公斤)',
        'BANTAM 雛量級 (28公斤以上而不超過31公斤)',
        'FEATHER 羽量級 (31公斤以上而不超過34公斤)',
        'LIGHT 輕量級 (34公斤以上而不超過37公斤)',
        'WELTER 沉量級 (37公斤以上而不超過40公斤)',
        'LIGHT MIDDLE 輕中量級 (40公斤以上而不超過43公斤)',
        'MIDDLE 中量級 (43公斤以上而不超過46公斤)',
        'LIGHT HEAVY 輕重量級 (46公斤以上而不超過49公斤)',
        'HEAVY 重量級 (49公斤以上而不超過53公斤)'
      ],
      '女童色帶C組 Girls Color Belt Group C 13歲至14歲 Age: 13 to 14 (2011年至2012年出生者)': [
        'FIN 鰭量級 (26公斤以上而不超過29公斤)',
        'FLY 蠅量級 (29公斤以上而不超過33公斤)',
        'BANTAM 雛量級 (33公斤以上而不超過37公斤)',
        'FEATHER 羽量級 (37公斤以上而不超過41公斤)',
        'LIGHT 輕量級 (41公斤以上而不超過44公斤)',
        'WELTER 沉量級 (44公斤以上而不超過47公斤)',
        'LIGHT MIDDLE 輕中量級 (47公斤以上而不超過51公斤)',
        'MIDDLE 中量級 (51公斤以上而不超過55公斤)',
        'LIGHT HEAVY 輕重量級 (55公斤以上而不超過59公斤)',
        'HEAVY 重量級 (59公斤以上)'
      ]
    };

    // 品勢級別劃分數據
    const poomsaeDivisions = {
      '男 Male': {
        '2018-2019': ['男童A組 Boys Group A 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)'],
        '2016-2017': ['男童B組 Boys Group B 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)'],
        '2014-2015': ['男童C組 Boys Group C 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)'],
        '2013': ['男童D組 Boys Group D 12歲或以上 Age: 12 or above (2013年或之前出生者)']
      },
      '女 Female': {
        '2018-2019': ['女童E組 Girls Group E 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)'],
        '2016-2017': ['女童F組 Girls Group F 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)'],
        '2014-2015': ['女童G組 Girls Group G 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)'],
        '2013': ['女童H組 Girls Group H 12歲或以上 Age: 12 or above (2013年或之前出生者)']
      }
    };

    // 參賽品勢數據
    const poomsaeOptions = {
      '男童A組 Boys Group A 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)': {
        '黃帶 Yellow Belt': ['A1M 男童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['A1M 男童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['A2M 男童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['A2M 男童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['A3M 男童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['A3M 男童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['A4M 男童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['A4M 男童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['A5M 男童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['A5M 男童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['A6M 男童品段 - 品三或以上 - 高麗']
      },
      '男童B組 Boys Group B 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)': {
        '黃帶 Yellow Belt': ['B1M 男童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['B1M 男童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['B2M 男童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['B2M 男童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['B3M 男童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['B3M 男童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['B4M 男童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['B4M 男童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['B5M 男童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['B5M 男童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['B6M 男童品段 - 品三或以上 - 高麗']
      },
      '男童C組 Boys Group C 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)': {
        '黃帶 Yellow Belt': ['C1M 男童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['C1M 男童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['C2M 男童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['C2M 男童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['C3M 男童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['C3M 男童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['C4M 男童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['C4M 男童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['C5M 男童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['C5M 男童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['C6M 男童品段 - 品三或以上 - 高麗']
      },
      '男童D組 Boys Group D 12歲或以上 Age: 12 or above (2013年或之前出生者)': {
        '黃帶 Yellow Belt': ['D1M 男童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['D1M 男童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['D2M 男童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['D2M 男童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['D3M 男童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['D3M 男童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['D4M 男童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['D4M 男童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['D5M 男童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['D5M 男童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['D6M 男童品段 - 品三或以上 - 高麗']
      },
      '女童E組 Girls Group E 6歲至7歲 Age: 6 to 7 (2018年至2019年出生者)': {
        '黃帶 Yellow Belt': ['E1F 女童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['E1F 女童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['E2F 女童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['E2F 女童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['E3F 女童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['E3F 女童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['E4F 女童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['E4F 女童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['E5F 女童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['E5F 女童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['E6F 女童品段 - 品三或以上 - 高麗']
      },
      '女童F組 Girls Group F 8歲至9歲 Age: 8 to 9 (2016年至2017年出生者)': {
        '黃帶 Yellow Belt': ['F1F 女童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['F1F 女童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['F2F 女童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['F2F 女童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['F3F 女童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['F3F 女童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['F4F 女童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['F4F 女童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['F5F 女童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['F5F 女童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['F6F 女童品段 - 品三或以上 - 高麗']
      },
      '女童G組 Girls Group G 10歲至11歲 Age: 10 to 11 (2014年至2015年出生者)': {
        '黃帶 Yellow Belt': ['G1F 女童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['G1F 女童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['G2F 女童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['G2F 女童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['G3F 女童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['G3F 女童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['G4F 女童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['G4F 女童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['G5F 女童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['G5F 女童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['G6F 女童品段 - 品三或以上 - 高麗']
      },
      '女童H組 Girls Group H 12歲或以上 Age: 12 or above (2013年或之前出生者)': {
        '黃帶 Yellow Belt': ['H1F 女童色帶 - 黃、黃綠 - 太極1'],
        '黃綠帶 Yellow-Green Belt': ['H1F 女童色帶 - 黃、黃綠 - 太極1'],
        '綠帶 Green Belt': ['H2F 女童色帶 - 綠、綠藍 - 太極3'],
        '綠藍帶 Green-Blue Belt': ['H2F 女童色帶 - 綠、綠藍 - 太極3'],
        '藍帶 Blue Belt': ['H3F 女童色帶 - 藍、藍紅 - 太極5'],
        '藍紅帶 Blue-Red Belt': ['H3F 女童色帶 - 藍、藍紅 - 太極5'],
        '紅帶 Red Belt': ['H4F 女童色帶 - 紅、紅黑 - 太極7'],
        '紅黑帶 Red-Black Belt': ['H4F 女童色帶 - 紅、紅黑 - 太極7'],
        '品一 Poom 1': ['H5F 女童品段 - 品一、品二 - 高麗'],
        '品二 Poom 2': ['H5F 女童品段 - 品一、品二 - 高麗'],
        '品三或上 Poom 3 or above': ['H6F 女童品段 - 品三或以上 - 高麗']
      }
    };

    // 表單驗證與提交
    function submitForm() {
      const confirmModal = document.getElementById('confirmModal');
      const form = document.getElementById('registrationForm');
      const schoolNameInput = document.getElementById('schoolName');
      const studentIdInput = document.getElementById('studentId');
      const affiliationSelect = document.getElementById('affiliation');
      const membershipNumberInput = document.getElementById('membershipNumber');
      const chineseNameInput = document.getElementById('chineseName');
      const englishNameInput = document.getElementById('englishName');
      const birthYearSelect = document.getElementById('birthYear');
      const birthMonthSelect = document.getElementById('birthMonth');
      const birthDaySelect = document.getElementById('birthDay');
      const genderRadios = document.getElementsByName('entry.1854501309');
      const phoneInput = document.getElementById('phone');
      const beltLevelSelect = document.getElementById('beltLevel');
      const eventRadios = document.getElementsByName('entry.629960054');
      const heightInput = document.getElementById('height');
      const weightInput = document.getElementById('weight');
      const kyorugiDivisionSelect = document.getElementById('kyorugiDivision');
      const weightCategorySelect = document.getElementById('weightCategory');
      const poomsaeDivisionSelect = document.getElementById('poomsaeDivision');
      const poomsaeSelect = document.getElementById('poomsae');

      let isValid = true;
      document.querySelectorAll('.error').forEach(error => error.style.display = 'none');

      // 設置日期輸入值
      const birthDateInput = document.getElementById('birthDate');
      if (birthYearSelect.value && birthMonthSelect.value && birthDaySelect.value) {
        birthDateInput.value = `${birthYearSelect.value}-${birthMonthSelect.value.toString().padStart(2, '0')}-${birthDaySelect.value.toString().padStart(2, '0')}`;
      }

      // 檢查是否為 "test" 模式
      const isTestMode = schoolNameInput.value.toLowerCase().includes('test');

      if (!isTestMode) {
        if (!schoolNameInput.value.trim()) {
          document.getElementById('schoolNameError').style.display = 'block';
          isValid = false;
        }
        if (!studentIdInput.value.trim()) {
          document.getElementById('studentIdError').style.display = 'block';
          isValid = false;
        }
        if (!affiliationSelect.value) {
          document.getElementById('affiliationError').style.display = 'block';
          isValid = false;
        }
        if (!membershipNumberInput.value.trim()) {
          document.getElementById('membershipNumberError').style.display = 'block';
          isValid = false;
        }
        if (!chineseNameInput.value.trim()) {
          document.getElementById('chineseNameError').style.display = 'block';
          isValid = false;
        }
        if (!englishNameInput.value.trim()) {
          document.getElementById('englishNameError').style.display = 'block';
          isValid = false;
        }
        if (!birthDateInput.value) {
          document.getElementById('birthDateError').style.display = 'block';
          isValid = false;
        }
        if (!Array.from(genderRadios).some(radio => radio.checked)) {
          document.getElementById('genderError').style.display = 'block';
          isValid = false;
        }
        if (!phoneInput.value.match(/^\d{8}$/)) {
          document.getElementById('phoneError').style.display = 'block';
          isValid = false;
        }
        if (!beltLevelSelect.value) {
          document.getElementById('beltLevelError').style.display = 'block';
          isValid = false;
        }
        if (!Array.from(eventRadios).some(radio => radio.checked)) {
          document.getElementById('eventError').style.display = 'block';
          isValid = false;
        }
        const selectedEvent = Array.from(eventRadios).find(radio => radio.checked)?.value;
        if (selectedEvent && (selectedEvent.includes('搏擊'))) {
          if (!heightInput.value || heightInput.value <= 0) {
            document.getElementById('heightError').style.display = 'block';
            isValid = false;
          }
          if (!weightInput.value || weightInput.value <= 0) {
            document.getElementById('weightError').style.display = 'block';
            isValid = false;
          }
          if (!kyorugiDivisionSelect.value) {
            document.getElementById('kyorugiDivisionError').style.display = 'block';
            isValid = false;
          }
          if (!weightCategorySelect.value) {
            document.getElementById('weightCategoryError').style.display = 'block';
            isValid = false;
          }
        }
        if (selectedEvent && (selectedEvent.includes('品勢'))) {
          if (!poomsaeDivisionSelect.value) {
            document.getElementById('poomsaeDivisionError').style.display = 'block';
            isValid = false;
          }
          if (!poomsaeSelect.value) {
            document.getElementById('poomsaeError').style.display = 'block';
            isValid = false;
          }
        }
      }

      if (isValid || isTestMode) {
        document.getElementById('confirmSchoolName').textContent = schoolNameInput.value || '未填寫';
        document.getElementById('confirmStudentId').textContent = studentIdInput.value || '未填寫';
        document.getElementById('confirmAffiliation').textContent = affiliationSelect.value || '未填寫';
        document.getElementById('confirmMembershipNumber').textContent = membershipNumberInput.value || '未填寫';
        document.getElementById('confirmChineseName').textContent = chineseNameInput.value || '未填寫';
        document.getElementById('confirmEnglishName').textContent = englishNameInput.value || '未填寫';
        document.getElementById('confirmBirthDate').textContent = birthDateInput.value || '未選擇';
        document.getElementById('confirmGender').textContent = Array.from(genderRadios).find(radio => radio.checked)?.value || '未選擇';
        document.getElementById('confirmPhone').textContent = phoneInput.value || '未填寫';
        document.getElementById('confirmBeltLevel').textContent = beltLevelSelect.value || '未選擇';
        document.getElementById('confirmEvent').textContent = Array.from(eventRadios).find(radio => radio.checked)?.value || '未選擇';
        document.getElementById('confirmHeight').textContent = heightInput.value || '未填寫';
        document.getElementById('confirmWeight').textContent = weightInput.value || '未填寫';
        document.getElementById('confirmKyorugiDivision').textContent = kyorugiDivisionSelect.value || '未選擇';
        document.getElementById('confirmWeightCategory').textContent = weightCategorySelect.value || '未選擇';
        document.getElementById('confirmPoomsaeDivision').textContent = poomsaeDivisionSelect.value || '未選擇';
        document.getElementById('confirmPoomsae').textContent = poomsaeSelect.value || '未選擇';
        confirmModal.style.display = 'flex';
      }
    }

    function cancelSubmission() {
      document.getElementById('confirmModal').style.display = 'none';
    }

    async function confirmSubmission() {
      const confirmModal = document.getElementById('confirmModal');
      const form = document.getElementById('registrationForm');
      const formContainer = document.getElementById('mainForm');
      const thankYouPage = document.getElementById('thankYouPage');
      const selectedEvent = Array.from(document.getElementsByName('entry.629960054')).find(radio => radio.checked)?.value;
      const formData = new FormData(form);

      // 根據參賽項目過濾資料
      if (selectedEvent === '搏擊') {
        formData.delete('entry.1721761818'); // 品勢級別劃分
        formData.delete('entry.1921234097'); // 參賽品勢
      } else if (selectedEvent === '品勢') {
        formData.delete('entry.703788026'); // 高度
        formData.delete('entry.1666612578'); // 重量
        formData.delete('entry.1924363147'); // 搏擊級別劃分
        formData.delete('entry.1084612574'); // 搏擊量級
      }

      try {
        const response = await fetch('https://docs.google.com/forms/d/e/1FAIpQLSfwydgGIL-COHGvXH8dMRos0JeF8c3Fy6hwfLltRdw6YOjlVQ/formResponse', {
          method: 'POST',
          body: formData,
          mode: 'no-cors'
        });
        console.log('表單提交成功');
        confirmModal.style.display = 'none';
        formContainer.style.display = 'none';
        thankYouPage.style.display = 'block';
      } catch (error) {
        console.error('提交失敗:', error);
        alert('表單提交失敗，請稍後再試或檢查控制台日誌。');
      }
    }

    function resetForm() {
      const form = document.getElementById('registrationForm');
      form.reset();
      document.querySelectorAll('.error').forEach(error => error.style.display = 'none');
      document.getElementById('kyorugiDivision').innerHTML = '<option value="">請選擇搏擊級別</option>';
      document.getElementById('weightCategory').innerHTML = '<option value="">請選擇量級</option>';
      document.getElementById('poomsaeDivision').innerHTML = '<option value="">請選擇品勢級別</option>';
      document.getElementById('poomsae').innerHTML = '<option value="">請選擇品勢</option>';
      toggleEventFields();
    }

    function restartForm() {
      const thankYouPage = document.getElementById('thankYouPage');
      const formContainer = document.getElementById('mainForm');
      thankYouPage.style.display = 'none';
      formContainer.style.display = 'block';
      resetForm();
    }

    // 動態生成日期選項
    function populateDateSelects(yearSelectId, monthSelectId, daySelectId, hiddenInputId) {
      const yearSelect = document.getElementById(yearSelectId);
      const monthSelect = document.getElementById(monthSelectId);
      const daySelect = document.getElementById(daySelectId);
      const hiddenInput = document.getElementById(hiddenInputId);

      // 生成年份選項 (2019 到 2000)
      for (let year = 2019; year >= 2000; year--) {
        let option = document.createElement('option');
        option.value = year;
        option.text = year;
        yearSelect.appendChild(option);
      }

      // 生成月份選項 (1 到 12)
      for (let month = 1; month <= 12; month++) {
        let option = document.createElement('option');
        option.value = month;
        option.text = month.toString().padStart(2, '0');
        monthSelect.appendChild(option);
      }

      function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
      }

      function updateDays() {
        const year = parseInt(yearSelect.value) || 2019;
        const month = parseInt(monthSelect.value) || 1;
        const prevDay = daySelect.value;
        daySelect.innerHTML = '<option value="">日</option>';
        if (year && month) {
          const daysInMonth = [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month - 1];
          for (let day = 1; day <= daysInMonth; day++) {
            let option = document.createElement('option');
            option.value = day;
            option.text = day.toString().padStart(2, '0');
            daySelect.appendChild(option);
          }
          if (prevDay && parseInt(prevDay) <= daysInMonth) {
            daySelect.value = prevDay;
          }
        }
        updateHiddenInput();
      }

      function updateHiddenInput() {
        const year = yearSelect.value;
        const month = monthSelect.value;
        const day = daySelect.value;
        if (year && month && day) {
          hiddenInput.value = `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
          updateEventOptions();
          updateKyorugiDivision();
          updatePoomsaeDivision();
        } else {
          hiddenInput.value = '';
        }
      }

      yearSelect.addEventListener('change', () => {
        updateDays();
        validateDate(yearSelectId, monthSelectId, daySelectId);
      });
      monthSelect.addEventListener('change', () => {
        updateDays();
        validateDate(yearSelectId, monthSelectId, daySelectId);
      });
      daySelect.addEventListener('change', () => {
        updateHiddenInput();
        validateDate(yearSelectId, monthSelectId, daySelectId);
      });

      updateDays();
    }

    // 日期驗證
    function validateDate(yearSelectId, monthSelectId, daySelectId) {
      const yearSelect = document.getElementById(yearSelectId);
      const monthSelect = document.getElementById(monthSelectId);
      const daySelect = document.getElementById(daySelectId);
      const errorElement = document.getElementById(`${yearSelectId.replace('Year', '')}Error`);
      if (yearSelect.value && monthSelect.value && daySelect.value) {
        const selectedDate = new Date(parseInt(yearSelect.value), parseInt(monthSelect.value) - 1, parseInt(daySelect.value));
        if (!isNaN(selectedDate)) {
          errorElement.style.display = 'none';
          return true;
        } else {
          errorElement.style.display = 'block';
          return false;
        }
      }
      errorElement.style.display = 'none';
      return true;
    }

    // 根據出生年份和級別限制參賽項目
    function updateEventOptions() {
      const birthYear = parseInt(document.getElementById('birthYear').value);
      const beltLevel = document.getElementById('beltLevel').value;
      const eventRadios = document.getElementsByName('entry.629960054');
      const isYoung = birthYear >= 2018;
      const isLowBelt = ['黃帶 Yellow Belt', '黃綠帶 Yellow-Green Belt', '品一 Poom 1', '品二 Poom 2', '品三或上 Poom 3 or above'].includes(beltLevel);

      eventRadios.forEach(radio => {
        if (isYoung || isLowBelt) {
          if (radio.value.includes('搏擊')) {
            radio.disabled = true;
            radio.checked = false;
            radio.nextElementSibling.style.color = '#b0b0b0'; // Gray out label
          } else {
            radio.disabled = false;
            radio.nextElementSibling.style.color = '#2c3e50'; // Normal color
          }
        } else {
          radio.disabled = false;
          radio.nextElementSibling.style.color = '#2c3e50'; // Normal color
        }
      });

      toggleEventFields();
    }

    // 根據參賽項目啟用/禁用相關欄位
    function toggleEventFields() {
      const selectedEvent = Array.from(document.getElementsByName('entry.629960054')).find(radio => radio.checked)?.value;
      const heightInput = document.getElementById('height');
      const weightInput = document.getElementById('weight');
      const kyorugiDivisionSelect = document.getElementById('kyorugiDivision');
      const weightCategorySelect = document.getElementById('weightCategory');
      const poomsaeDivisionSelect = document.getElementById('poomsaeDivision');
      const poomsaeSelect = document.getElementById('poomsae');

      if (selectedEvent && (selectedEvent.includes('搏擊'))) {
        heightInput.disabled = false;
        weightInput.disabled = false;
        kyorugiDivisionSelect.disabled = false;
        weightCategorySelect.disabled = false;
      } else {
        heightInput.disabled = true;
        weightInput.disabled = true;
        kyorugiDivisionSelect.disabled = true;
        weightCategorySelect.disabled = true;
        heightInput.value = '';
        weightInput.value = '';
        kyorugiDivisionSelect.value = '';
        weightCategorySelect.value = '';
      }

      if (selectedEvent && (selectedEvent.includes('品勢'))) {
        poomsaeDivisionSelect.disabled = false;
        poomsaeSelect.disabled = false;
      } else {
        poomsaeDivisionSelect.disabled = true;
        poomsaeSelect.disabled = true;
        poomsaeDivisionSelect.value = '';
        poomsaeSelect.value = '';
      }

      updateKyorugiDivision();
      updateWeightCategory();
      updatePoomsaeDivision();
      updatePoomsae();
    }

    // 更新搏擊級別劃分
    function updateKyorugiDivision() {
      const birthYear = parseInt(document.getElementById('birthYear').value);
      const selectedGender = Array.from(document.getElementsByName('entry.1854501309')).find(radio => radio.checked)?.value;
      const kyorugiDivisionSelect = document.getElementById('kyorugiDivision');
      kyorugiDivisionSelect.innerHTML = '<option value="">請選擇搏擊級別</option>';

      let yearRange;
      if (birthYear >= 2015 && birthYear <= 2017) {
        yearRange = '2015-2017';
      } else if (birthYear >= 2013 && birthYear <= 2014) {
        yearRange = '2013-2014';
      } else if (birthYear >= 2011 && birthYear <= 2012) {
        yearRange = '2011-2012';
      }

      if (selectedGender && yearRange && kyorugiDivisions[selectedGender] && kyorugiDivisions[selectedGender][yearRange]) {
        kyorugiDivisions[selectedGender][yearRange].forEach(division => {
          let option = document.createElement('option');
          option.value = division;
          option.text = division;
          kyorugiDivisionSelect.appendChild(option);
        });
        // 自動選擇第一個選項
        if (kyorugiDivisions[selectedGender][yearRange].length > 0) {
          kyorugiDivisionSelect.value = kyorugiDivisions[selectedGender][yearRange][0];
        }
      }

      updateWeightCategory();
    }

    // 更新搏擊量級
    function updateWeightCategory() {
      const kyorugiDivision = document.getElementById('kyorugiDivision').value;
      const weightInput = document.getElementById('weight');
      const weightCategorySelect = document.getElementById('weightCategory');
      weightCategorySelect.innerHTML = '<option value="">請選擇量級</option>';

      if (kyorugiDivision && weightCategories[kyorugiDivision]) {
        weightCategories[kyorugiDivision].forEach(category => {
          let option = document.createElement('option');
          option.value = category;
          option.text = category;
          weightCategorySelect.appendChild(option);
        });

        // 根據重量自動選擇量級
        const weight = parseFloat(weightInput.value);
        if (weight && kyorugiDivision) {
          const categories = weightCategories[kyorugiDivision];
          let selectedCategory = '';
          for (let category of categories) {
            const rangeMatch = category.match(/\((\d+\.?\d*)\s*公斤(以上|以下|.*不超過\s*(\d+\.?\d*)\s*公斤)?/);
            if (rangeMatch) {
              const lowerBound = parseFloat(rangeMatch[1]);
              const upperBound = rangeMatch[3] ? parseFloat(rangeMatch[3]) : Infinity;
              if (rangeMatch[2] === '以下' && weight <= lowerBound) {
                selectedCategory = category;
                break;
              } else if (rangeMatch[2] === '以上' && weight >= lowerBound) {
                selectedCategory = category;
                break;
              } else if (weight >= lowerBound && weight <= upperBound) {
                selectedCategory = category;
                break;
              }
            }
          }
          if (selectedCategory) {
            weightCategorySelect.value = selectedCategory;
          }
        }
      }
    }

    // 更新品勢級別劃分
    function updatePoomsaeDivision() {
      const birthYear = parseInt(document.getElementById('birthYear').value);
      const selectedGender = Array.from(document.getElementsByName('entry.1854501309')).find(radio => radio.checked)?.value;
      const poomsaeDivisionSelect = document.getElementById('poomsaeDivision');
      poomsaeDivisionSelect.innerHTML = '<option value="">請選擇品勢級別</option>';

      let yearRange;
      if (birthYear >= 2018) {
        yearRange = '2018-2019';
      } else if (birthYear >= 2016 && birthYear <= 2017) {
        yearRange = '2016-2017';
      } else if (birthYear >= 2014 && birthYear <= 2015) {
        yearRange = '2014-2015';
      } else if (birthYear <= 2013) {
        yearRange = '2013';
      }

      if (selectedGender && yearRange && poomsaeDivisions[selectedGender] && poomsaeDivisions[selectedGender][yearRange]) {
        poomsaeDivisions[selectedGender][yearRange].forEach(division => {
          let option = document.createElement('option');
          option.value = division;
          option.text = division;
          poomsaeDivisionSelect.appendChild(option);
        });
        // 自動選擇第一個選項
        if (poomsaeDivisions[selectedGender][yearRange].length > 0) {
          poomsaeDivisionSelect.value = poomsaeDivisions[selectedGender][yearRange][0];
        }
      }

      updatePoomsae();
    }

    // 更新參賽品勢
    function updatePoomsae() {
      const poomsaeDivision = document.getElementById('poomsaeDivision').value;
      const beltLevel = document.getElementById('beltLevel').value;
      const poomsaeSelect = document.getElementById('poomsae');
      poomsaeSelect.innerHTML = '<option value="">請選擇品勢</option>';

      if (poomsaeDivision && beltLevel && poomsaeOptions[poomsaeDivision] && poomsaeOptions[poomsaeDivision][beltLevel]) {
        poomsaeOptions[poomsaeDivision][beltLevel].forEach(poomsae => {
          let option = document.createElement('option');
          option.value = poomsae;
          option.text = poomsae;
          poomsaeSelect.appendChild(option);
        });
        // 自動選擇第一個選項
        if (poomsaeOptions[poomsaeDivision][beltLevel].length > 0) {
          poomsaeSelect.value = poomsaeOptions[poomsaeDivision][beltLevel][0];
        }
      }
    }

    // 屬會搜尋功能
    function setupAffiliationSearch() {
      const affiliationSearch = document.getElementById('affiliationSearch');
      const affiliationSelect = document.getElementById('affiliation');

      affiliationSearch.addEventListener('input', () => {
        const filter = affiliationSearch.value.toLowerCase();
        const options = affiliationSelect.options;

        for (let i = 1; i < options.length; i++) {
          const optionText = options[i].text.toLowerCase();
          options[i].style.display = optionText.includes(filter) ? '' : 'none';
        }
      });
    }

    // 監聽參賽項目變化
    document.getElementsByName('entry.629960054').forEach(radio => {
      radio.addEventListener('change', () => {
        toggleEventFields();
        updateKyorugiDivision();
        updateWeightCategory();
        updatePoomsaeDivision();
        updatePoomsae();
      });
    });

    // 監聽性別變化
    document.getElementsByName('entry.1854501309').forEach(radio => {
      radio.addEventListener('change', () => {
        updateKyorugiDivision();
        updatePoomsaeDivision();
      });
    });

    // 監聽級別變化
    document.getElementById('beltLevel').addEventListener('change', () => {
      updateEventOptions();
      updatePoomsae();
    });

    // 監聽重量變化
    document.getElementById('weight').addEventListener('input', updateWeightCategory);

    // 初始化日期選項
    populateDateSelects('birthYear', 'birthMonth', 'birthDay', 'birthDate');

    // 初始化屬會搜尋
    setupAffiliationSearch();

    // 頁面加載時初始化
    document.addEventListener('DOMContentLoaded', () => {
      resetForm();
      updateEventOptions();
    });
  </script>
</body>
</html>
